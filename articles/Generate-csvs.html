<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LCr">
<title>Generate SIS Connect files for multiple plant species • LCr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate SIS Connect files for multiple plant species">
<meta property="og:description" content="LCr">
<meta property="og:image" content="https://stevenpbachman.github.io/LCr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LCr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Generate-csvs.html">Generate SIS Connect files for multiple plant species</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/stevenpbachman/LCr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate SIS Connect files for multiple plant species</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stevenpbachman/LCr/blob/HEAD/vignettes/Generate-csvs.Rmd" class="external-link"><code>vignettes/Generate-csvs.Rmd</code></a></small>
      <div class="d-none name"><code>Generate-csvs.Rmd</code></div>
    </div>

    
    
<p>The aim of <code>LCr</code> is to speed up the process of adding
Least Concern (LC) species to the <a href="https://www.iucnredlist.org/" class="external-link">IUCN Red List</a>. We’ll start with
a list of plant species and end up with a zip file of CSV files that
contain the minimal required information to support a Least Concern
assessment. The zip file can then be uploaded into the IUCN Species
Informaiton System (SIS) via <a href="https://connect.iucnredlist.org/" class="external-link">SIS Connect</a> (requires
registration) where the draft assessments can be edited, reviewed and
hopefully published on the IUCN Red List in due course. Spatial data to
support the assessment is also generated by <code>LCr</code>.</p>
<p>Before you start, make sure you have the <code>rWCVP</code> package
installed along with the associated data package <code>rWCVPdata</code>.
For more information see the <a href="https://matildabrown.github.io/rWCVP/articles/rWCVP.html" class="external-link">Getting
Started</a> guide.</p>
<p>Load the <code>LCr</code> library:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stevenpbachman/LCr" class="external-link">LCr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/matildabrown/rWCVP" class="external-link">rWCVP</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'matildabrown/rWCVPdata'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #00BBBB;">R CMD build</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; * checking for file ‘/tmp/Rtmp9zloIz/remotes1c03141804df/matildabrown-rWCVPdata-57e4f61/DESCRIPTION’ ... OK</span></span>
<span><span class="co">#&gt; * preparing ‘rWCVPdata’:</span></span>
<span><span class="co">#&gt; * checking DESCRIPTION meta-information ... OK</span></span>
<span><span class="co">#&gt; * checking for LF line-endings in source and make files and shell scripts</span></span>
<span><span class="co">#&gt; * checking for empty or unneeded directories</span></span>
<span><span class="co">#&gt; * building ‘rWCVPdata_0.5.0.tar.gz’</span></span></code></pre></div>
<div class="section level3">
<h3 id="get-name-keys-from-a-species-list">Get name keys from a species list<a class="anchor" aria-label="anchor" href="#get-name-keys-from-a-species-list"></a>
</h3>
<p>The first step is to determine the list of LC species that you want
to document. A <a href="https://nph.onlinelibrary.wiley.com/doi/full/10.1111/nph.19592" class="external-link">study</a>
predicted extinction risk for all species of flowering plants
(Angiosperms). You can filter on species that are confidently predicted
to be LC, or manually generate a data frame from a list as shown
below.</p>
<p>Note that predictions can be wrong so please verify that your
selected species are genuine LC species. A useful resource to help
determine whether your species is LC is to check whether it has
previously been assessed. The <a href="https://tools.bgci.org/threat_search.php" class="external-link">ThreatSearch</a>
resource maintained by BGCI contains evidence-based plant conservation
assessments compiled from digital resources including national/regional
Red Lists.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lc_species</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Crabbea acaulis"</span>, <span class="st">"Crabbea cirsioides"</span>, <span class="st">"Crabbea nana"</span>, <span class="st">"Crabbea velutina"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lc_species</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   sp</span></span>
<span><span class="co">#&gt; 1    Crabbea acaulis</span></span>
<span><span class="co">#&gt; 2 Crabbea cirsioides</span></span>
<span><span class="co">#&gt; 3       Crabbea nana</span></span>
<span><span class="co">#&gt; 4   Crabbea velutina</span></span></code></pre></div>
<p>Next we can reconcile the names against other data sources using
existing packages such as <code>rWCVP</code> and <code>rgbif</code>.
This will provide us with name keys that can be used to search for data
on those species.</p>
<p>In this case we want to enforce a single matching name for every name
in our list so we set the <code>match</code> parameter to ‘single’, but
you can set this to ‘multiple’ if you wish to allow multiple matches.
Similarly, we want to focus only on accepted species, so we set the
<code>tax_status</code> parameter to ‘accepted’, but you can set this to
‘any’ if you wish to return a different taxonomic status.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lc_keys</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/get_name_keys.html">get_name_keys</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">lc_species</span>,</span>
<span>    name_column <span class="op">=</span> <span class="st">"sp"</span>,</span>
<span>    tax_status <span class="op">=</span> <span class="st">"accepted"</span>,</span>
<span>    match <span class="op">=</span> <span class="st">"single"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># take a look at the resulting table</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">lc_keys</span><span class="op">)</span></span></code></pre></div>
<p>The name matching went well. I’ve checked the authors and I’m happy
that the names match to the correct concept for these taxa. Note that it
is worth spending time with the name matching step to ensure you are
using a consistent concept for the taxa you are working with across GBIF
and WCVP. Adjust the <code>tax_status</code> and <code>match</code>
parameters for more fuzzy searching.</p>
<p>We now have some useful fields to help us find more data for these
species. The <code>GBIF_usageKey</code> is an identifier for species
according to the GBIF name backbone and the <code>wcvp_ipni_id</code>
identifies the species according to the WCVP name backbone.</p>
</div>
<div class="section level3">
<h3 id="generate-an-lc-point-file">Generate an LC point file<a class="anchor" aria-label="anchor" href="#generate-an-lc-point-file"></a>
</h3>
<p>Use the <code>make_LC_points</code> function to kick off a download
from GBIF, clean the downloaded occurences, and reformat them to IUCN
spatial standards. Name information is required for the standard point
file. Set the <code>range_check</code> parameter to <code>TRUE</code> if
you want to exclude points outside the native range according to
<code>WCVP</code>, otherwise standard cleaning protocols are applied
using the <code>CoordinateCleaner</code> package.</p>
<p>Note that we will use the <code>rGBIF</code> package to obtain the
occurrence data. You will need to set up your GBIF credentials to obtain
the downloads. After you have set up an account at <a href="https://www.gbif.org/" class="external-link">GBIF</a> you need to register your
credentials in the r environment - see this <a href="https://docs.ropensci.org/rgbif/articles/gbif_credentials.html" class="external-link">post</a>
for an explanation.</p>
<p>The IUCN spatial point standards require some fields relating to the
data compiler and associated institution. These can be manually entered
as below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lc_sis_occs</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_LC_points.html">make_LC_points</a></span><span class="op">(</span></span>
<span>    keys_df <span class="op">=</span> <span class="va">lc_keys</span>,</span>
<span>    first_name <span class="op">=</span> <span class="st">"Steven"</span>,</span>
<span>    second_name <span class="op">=</span> <span class="st">"Bachman"</span>,</span>
<span>    institution <span class="op">=</span> <span class="st">"Royal Botanic Gardens, Kew"</span>,</span>
<span>    range_check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># save the file - you'll need to submit this to IUCN</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">lc_points</span><span class="op">$</span><span class="va">points</span>, <span class="st">"lc_points_fungi.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Some occurrence records were removed as they did not pass the
cleaning tests or were outside the native range. Note that the output
from <code>make_LC_points</code> will likely be a large list with two or
three objects: a data frame of occurrences called <code>points</code>, a
data frame called <code>citation</code> that holds the citation details
for this download, and if you set <code>range_check = TRUE</code> it
will also return the native ranges as a data frame. The GBIF citation is
important to retain as we need to cite the use of this data in the Red
List assessment and we’ll add this to the reference file later on.</p>
</div>
<div class="section level3">
<h3 id="generate-lc-csv-files">Generate LC CSV files<a class="anchor" aria-label="anchor" href="#generate-lc-csv-files"></a>
</h3>
<p>We can now generate the LC csv files. We can use the
<code>wcvp_ipni_id</code> field as a unique identifier. We need to add
the assessor details again as this is registered in the credits csv
file, note that the email address is also required. Now we can add our
GBIF citation back in so that it goes in the references csv file.
Finally, the native ranges we generated earlier can be used to help
define the list of countries that our species are native to.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lc_sis_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_sis_csvs.html">make_sis_csvs</a></span><span class="op">(</span>unique_id <span class="op">=</span> <span class="va">lc_keys</span><span class="op">$</span><span class="va">wcvp_ipni_id</span>,</span>
<span>                              wcvp_ipni_id <span class="op">=</span> <span class="va">lc_keys</span><span class="op">$</span><span class="va">wcvp_ipni_id</span>,</span>
<span>                              first_name <span class="op">=</span> <span class="st">"Steven"</span>,</span>
<span>                              second_name <span class="op">=</span> <span class="st">"Bachman"</span>,</span>
<span>                              email <span class="op">=</span> <span class="st">"s.bachman@kew.org"</span>,</span>
<span>                              institution <span class="op">=</span> <span class="st">"Royal Botanic Gardens, Kew"</span>,</span>
<span>                              gbif_ref <span class="op">=</span> <span class="va">lc_sis_occs</span><span class="op">$</span><span class="va">citation</span>,</span>
<span>                              native_ranges <span class="op">=</span> <span class="va">lc_sis_occs</span><span class="op">$</span><span class="va">native_ranges</span></span>
<span>                              <span class="op">)</span></span></code></pre></div>
<p>The final step is to make a ZIP file as this is needed to import the
data into <a href="https://connect.iucnredlist.org/" class="external-link">SIS Connect</a>.
With the <code>lc_sis_files</code> list object we just created we run
the <code>make_zip</code> function that saves the zip file to your
current working directory.</p>
<p>All done! Send those LC species to the Red list and start working on
the next batch.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_zip.html">make_zip</a></span><span class="op">(</span><span class="va">lc_sis_files</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steven Bachman, Matilda Brown.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
